<footer class='bg-light py-4 py-md-5 mt-5'>
  <div class='container-fluid'>
    <div class='row justify-content-between'>
      <div class='col-md-3'>
        <h4 class=''>Contact us</h4>
        <form
          method='POST'
          action='https://submit-form.com/KXDjP2f8D'
          data-botpoison-public-key='pk_3370a845-4a8c-435e-b8d3-ca6855b31d81'
          class='form contact-form d-flex flex-column gap-1'
          id='contact-form'
        >
          <input type='hidden' name='_feedback.whitelabel' value='true' />
          <input type='hidden' name='_append' value='false' />
          <input type='hidden' name='_redirect' id='contact-redirect' value='' />

          <div class='input-group'>
            <input
              name='name'
              type='text'
              class='form-control form-control-sm rounded-0 fw-light'
              placeholder='Name'
              required
            />
          </div>
          <div class='input-group'>
            <input
              name='email'
              type='email'
              class='form-control form-control-sm rounded-0 fw-light'
              placeholder='Email'
              required
            />
          </div>
          <div class='input-group'>
            <input
              name='subject'
              type='text'
              class='form-control form-control-sm rounded-0 fw-light'
              placeholder='Subject'
              required
            />
          </div>
          <div class='input-group'>
            <textarea
              name='message'
              rows='3'
              class='form-control form-control-sm rounded-0 fw-light'
              placeholder='Message'
              required></textarea>
          </div>
          <div class='input-group'>
            <button type='submit' class='btn btn-dark submit contact-submit-button px-3 rounded-0'
              >Send</button
            >
          </div>
          <!-- Inline feedback area -->
          <div id='contact-feedback' class='mt-2 d-none small text-secondary'></div>
        </form>
      </div>

      <div class='col-md-2 d-flex flex-column justify-content-end text-end'>
        <ul
          class='d-flex flex-column list-unstyled mb-0 fw-lighter text-secondary font-monospace small'
        >
          <li>SALVIS, s.r.o.</li>
          <li>Karadžičova 16</li>
          <li>Bratislava</li>
          <li class='mb-3'>821 08</li>
          <li>+421 911 969 333</li>
          <li>info@salvis.sk</li>
        </ul>
      </div>
    </div>

    <div class='row mt-md-5 fw-light d-flex d-row justify-content-between border-bottom'>
      <nav class='col-md-6' aria-label='Legal links'>
        <ul class='nav small flex-row'>
          <li class='nav-item'>
            <a href='/terms-and-conditions' class='nav-link py-1 ps-0 link-secondary'>
              Terms and Conditions
            </a>
          </li>
          <li class='nav-item'>
            <a href='/privacy-policy' class='nav-link py-1 link-secondary'> Privacy Policy </a>
          </li>
          <li class='nav-item'>
            <a href='/cookies-policy' class='nav-link py-1 link-secondary'> Cookies </a>
          </li>
        </ul>
      </nav>
      <div class='col-md-6 text-end'>
        <p class='copyright pt-1 small text-secondary'>
          {new Date().getFullYear()} | SALVIS
        </p>
      </div>
    </div>
  </div>
</footer>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contact-form')
    const submitBtn = form.querySelector('.contact-submit-button')
    const feedback = document.getElementById('contact-feedback')

    // Build “same page” redirect URL with a flag and a hash
    const url = new URL(window.location.href)
    url.hash = 'contact-form' // jump back to form
    const successUrl = new URL(url)
    successUrl.searchParams.set('contact', 'ok')
    const errorUrl = new URL(url)
    errorUrl.searchParams.set('contact', 'err')

    // Fill hidden redirect fields for Formspark
    document.getElementById('contact-redirect').value = successUrl.toString()
    const errField = document.getElementById('contact-error')
    if (errField) errField.value = errorUrl.toString() // used if Formspark honors _error

    // Button loading state (works even with full redirect)
    form.addEventListener('submit', () => {
      submitBtn.disabled = true
      submitBtn.textContent = 'Sending...'
    })

    // After redirect back, show inline message based on query
    const qp = new URLSearchParams(window.location.search)
    const state = qp.get('contact') // 'ok' | 'err' | null
    if (state && feedback) {
      if (state === 'ok') {
        feedback.className = 'alert alert-success mt-2'
        feedback.textContent =
          'Thank you for reaching out. Your message has been successfully sent and a member of our team will contact you shortly.'
        // (Optional) fire analytics
        window.dataLayer?.push({ event: 'contact_submit_success' })
      } else if (state === 'err') {
        feedback.className = 'alert alert-danger mt-2'
        feedback.textContent = 'Something went wrong. Please try again.'
        window.dataLayer?.push({ event: 'contact_submit_error' })
      }
      // Clean the URL so refresh doesn’t re-show the message
      const clean = new URL(window.location.href)
      clean.searchParams.delete('contact')
      history.replaceState({}, '', clean.toString())
    }
  })
</script>
