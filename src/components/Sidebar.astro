---
const normalize = (p: string) =>
  (p || '/')
    .replace(/\/+$/, '')
    .replace(/\/{2,}/g, '/')
    .replace(/^$/, '/')

const pathname = normalize(Astro.url.pathname) // e.g. "/services/breeam"

const isActiveHref = (href: string) => {
  const target = normalize(href)
  return pathname === target || pathname.startsWith(`${target}/`)
}

type Item = { href: string; label: string }

const items: Item[] = [
  { href: '/services/breeam', label: 'BREEAM' },
  { href: '/services/breeam-pre-logisticke-haly', label: 'BREEAM pre logistické haly' },
  { href: '/services/breeam-in-use', label: 'BREEAM In-Use' },
  { href: '/services/leed', label: 'LEED' },
  { href: '/services/leed-om', label: 'LEED O+M' },
  {
    href: '/services/dekarbonizacia-existujucich-budov',
    label: 'Dekarbonizácia existujúcich budov'
  },
  { href: '/services/epd', label: 'EPD' },
  { href: '/services/taxonomia-eu', label: 'Taxonómia EÚ' },
  { href: '/services/simulacie-budov', label: 'Simulácie budov' }
]
---

<nav aria-label='Sidebar'>
  <ul class='nav flex-column mb-auto sticky-top sidebar' id='sidebar'>
    {
      items.map((item, i) => {
        const active = isActiveHref(item.href)
        return (
          <li class={`nav-item border-bottom${i === items.length - 1 ? '' : ''}`}>
            <a
              href={item.href}
              class={`nav-link ps-0 rounded-0 ${active ? 'active' : 'link-dark'}`}
              aria-current={active ? 'page' : undefined}
            >
              {item.label}
            </a>
          </li>
        )
      })
    }
  </ul>
</nav>

<style>
  #sidebar {
    top: 6.9rem;
  }
  .nav-link {
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }
  .nav-item {
    transition: background-color 0.25s ease;
  }
  .nav-item:hover {
    background-color: var(--bs-light);
  }
</style>
